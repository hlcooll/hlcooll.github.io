<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.74.3" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>hlcooll</title>
  <meta name="description" content="blog" />

  
  <link type="text/css" rel="stylesheet" href="https://hlcooll.github.io/public/css/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="https://hlcooll.github.io/public/css/poole.css">
  <link type="text/css" rel="stylesheet" href="https://hlcooll.github.io/public/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="https://hlcooll.github.io/public/css/hyde.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="https://hlcooll.github.io/public/index.xml" rel="alternate" type="application/rss+xml" title="hlcooll" />
  
</head>

  <body class="theme-base-0d layout-reverse">
  <aside class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://hlcooll.github.io/public/"><h1>hlcooll</h1></a>
      <p class="lead">
       blog 
      </p>
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li><a href="https://hlcooll.github.io/public/">Home</a> </li>
        <li><a href="https://github.com/hlcooll"> Github </a></li>
      </ul>
    </nav>

    <p>&copy; 2020. All rights reserved. </p>
  </div>
</aside>

    <main class="content container">
    <div class="posts">
<article class="post">
  <h1 class="post-title">
    <a href="https://hlcooll.github.io/public/kubernetes/helm/graylogs/">Graylogs</a>
  </h1>
  <time datetime="2020-10-16T10:12:53&#43;0800" class="post-date">Fri, Oct 16, 2020</time>
  #mongodb
# Warning FailedCreate 30s (x14 over 71s) statefulset-controller create Pod mongodb-replicaset-1602575807-0 in StatefulSet mongodb-replicaset-1602575807 failed error: Pod &quot;mongodb-replicaset-1602575807-0&quot; is invalid: spec.containers[0].startupProbe.successThreshold: Invalid value: 2: must be 1 helm fetch stable/mongodb-replicaset kubectl create namespace mongodb helm install mongodb-replicaset --namespace &quot;graylog&quot; -n &quot;mongodb&quot; stable/mongodb-replicaset --set persistentVolume.storageClass=&quot;nfs-client&quot; --set startupProbe.successThreshold=&quot;1&quot; WARNING: This chart is deprecated NAME: mongodb-replicaset LAST DEPLOYED: Fri Oct 16 10:17:48 2020 NAMESPACE: mongodb STATUS: deployed REVISION: 1 NOTES: ******************* ****DEPRECATED***** ******************* * * This chart is deprecated and no longer maintained.
  
  <div class="read-more-link">
    <a href="/public/kubernetes/helm/graylogs/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://hlcooll.github.io/public/kubernetes/helm/helm/">Helm</a>
  </h1>
  <time datetime="2020-10-15T18:03:52&#43;0800" class="post-date">Thu, Oct 15, 2020</time>
  #安装Helm3
#下载： wget https://get.helm.sh/helm-v3.3.1-linux-amd64.tar.gz curl -L -o helm-v3.2.4-linux-amd64.tar.gz https://file.choerodon.com.cn/kubernetes-helm/v3.2.4/helm-v3.2.4-linux-amd64.tar.gz #官方安装文档 curl https://raw.githubusercontent.com/kubernetes/helm/master/scripts/get &gt; get_helm.sh 解压压缩包（以linux-amd64为例） tar -zxvf helm-v3.2.4-linux-amd64.tar.gz 将文件移动到PATH目录中（以linux-amd64为例） sudo mv linux-amd64/helm /usr/bin/helm chmod a+x /usr/bin/helm #验证部署 执行命令，出现以下信息即部署成功。 helm version #配置仓库 helm repo add aliyun https://kubernetes.oss-cn-hangzhou.aliyuncs.com/charts 
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://hlcooll.github.io/public/kubernetes/helm/nfs-sc/">Nfs Sc</a>
  </h1>
  <time datetime="2020-10-15T18:02:24&#43;0800" class="post-date">Thu, Oct 15, 2020</time>
  https://github.com/kubernetes-retired/external-storage/tree/master/nfs-client
#创建nfs-sc helm install stable/nfs-client-provisioner &ndash;set nfs.server=172.17.16.14 &ndash;set nfs.path=/data/u01/prod
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://hlcooll.github.io/public/kubernetes/ingress-tls/">Ingress Tls</a>
  </h1>
  <time datetime="2020-10-15T17:31:29&#43;0800" class="post-date">Thu, Oct 15, 2020</time>
  kubectl -n kubernetes-dashboard create secret tls hl-https --cert=hlcooll.crt --key=hlcooll.key apiVersion: extensions/v1beta1 kind: Ingress metadata: name: kubernetes-dashboard spec: tls: - hosts: - dashboard.hlcool.top secretName: https rules: - host: sslexample.foo.com http: paths: - path: / backend: serviceName: kubernetes-dashboard servicePort: 80 
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://hlcooll.github.io/public/kubernetes/k8s-affinity/">K8s Affinity</a>
  </h1>
  <time datetime="2020-10-12T11:15:57&#43;0800" class="post-date">Mon, Oct 12, 2020</time>
  k8s学习笔记-调度之Affinity Kubernetes中的调度策略可以大致分为两种 一种是全局的调度策略，要在启动调度器时配置，包括kubernetes调度器自带的各种predicates和priorities算法，具体可以参看上一篇文章； 另一种是运行时调度策略，包括nodeAffinity（主机亲和性），podAffinity（POD亲和性）以及podAntiAffinity（POD反亲和性）。 nodeAffinity 主要解决POD要部署在哪些主机，以及POD不能部署在哪些主机上的问题，处理的是POD和主机之间的关系。 podAffinity 主要解决POD可以和哪些POD部署在同一个拓扑域中的问题（拓扑域用主机标签实现，可以是单个主机，也可以是多个主机组成的cluster、zone等。） podAntiAffinity主要解决POD不能和哪些POD部署在同一个拓扑域中的问题。它们处理的是Kubernetes集群内部POD和POD之间的关系。 三种亲和性和反亲和性策略的比较如下表所示： 策略名称	匹配目标	支持的操作符	支持拓扑域	设计目标 nodeAffinity	主机标签	In，NotIn，Exists，DoesNotExist，Gt，Lt	不支持	决定Pod可以部署在哪些主机上 podAffinity	Pod标签	In，NotIn，Exists，DoesNotExist	支持	决定Pod可以和哪些Pod部署在同一拓扑域 PodAntiAffinity	Pod标签	In，NotIn，Exists，DoesNotExist	支持	决定Pod不可以和哪些Pod部署在同一拓扑域 亲和性：应用A与应用B两个应用频繁交互，所以有必要利用亲和性让两个应用的尽可能的靠近，甚至在一个node上，以减少因网络通信而带来的性能损耗。 反亲和性：当应用的采用多副本部署时，有必要采用反亲和性让各个应用实例打散分布在各个node上，以提高HA。 主要介绍kubernetes的中调度算法中的Node affinity和Pod affinity用法 实际上是对前文提到的优选策略中的NodeAffinityPriority策略和InterPodAffinityPriority策略的具体应用。 kubectl explain pods.spec.affinity 亲和性策略（Affinity）能够提供比NodeSelector或者Taints更灵活丰富的调度方式，例如： 丰富的匹配表达式（In, NotIn, Exists, DoesNotExist. Gt, and Lt） 软约束和硬约束（Required/Preferred） 以节点上的其他Pod作为参照物进行调度计算 亲和性策略分为NodeAffinityPriority策略和InterPodAffinityPriority策略。 先回顾一下之前的节点选择器 节点选择器： nodeSelector nodeName 创建一个Pod 节点选择器标签 nodeSelector: disktype: ssd 默认节点没这个标签：所以会调度失败 [root@k8s-master schedule]# kubectl get node --show-labels|egrep disktype [root@k8s-master schedule]# kubectl get pods NAME READY STATUS RESTARTS AGE pod-demo 0/1 Pending 0 11s [root@k8s-master schedule]# kubectl describe pod pod-demo Warning FailedScheduling 28s (x2 over 28s) default-scheduler 0/3 nodes are available: 3 node(s) didn't match node selector.
  
  <div class="read-more-link">
    <a href="/public/kubernetes/k8s-affinity/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://hlcooll.github.io/public/hugo/archetypes-new/">Archetypes New</a>
  </h1>
  <time datetime="2020-10-10T13:54:11&#43;0800" class="post-date">Sat, Oct 10, 2020</time>
  
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://hlcooll.github.io/public/hugo/hugo/">HUGO</a>
  </h1>
  <time datetime="2020-09-15T14:37:56&#43;0800" class="post-date">Tue, Sep 15, 2020</time>
  Hugo 能做什么 通过 Hugo 你可以快速搭建你的静态网站，比如博客系统、文档介绍、公司主页、产品介绍等等。相对于其他静态网站生成器来说，Hugo 具备如下特点： 极快的页面编译生成速度。（ ~1 ms 每页面） 完全跨平台支持，可以运行在 Mac OS X, Linux, Windows, 以及更多! 安装方便 Installation 本地调试 Usage 时通过 LiveReload 自动即时刷新页面。 完全的皮肤支持。 可以部署在任何的支持 HTTP 的服务器上。  Hugo 官方下载地址 https://github.com/gohugoio/hugo/releases Hugo 官网资料 #doc https://gohugo.io/getting-started/installing/ #主题 https://themes.gohugo.io/ Hugo 命令 查看版本 hugo version Hugo 创建 hugo new site hlcooll Hugo 安装主题 # 主题地址https://themes.gohugo.io/hyde/ cd themes/ git clone https://github.com/spf13/hyde.git 修改config.toml baseURL = &quot;https://hlcooll.github.io/&quot; languageCode = &quot;en-us&quot; #HTML的title标题 title = &quot;hlcooll&quot; #主题 theme = &quot;hyde&quot; #侧边栏菜单 [Menus] main = [ {Name = &quot;Github&quot;, URL = &quot;https://github.
  
  <div class="read-more-link">
    <a href="/public/hugo/hugo/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://hlcooll.github.io/public/post/ceshi/">Ceshi</a>
  </h1>
  <time datetime="2020-09-15T11:10:42&#43;0800" class="post-date">Tue, Sep 15, 2020</time>
  
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://hlcooll.github.io/public/post/helm/">HELM</a>
  </h1>
  <time datetime="2020-09-15T10:56:53&#43;0800" class="post-date">Tue, Sep 15, 2020</time>
  ssss
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://hlcooll.github.io/public/kubernetes/kubernetes/">Kubernetes</a>
  </h1>
  <time datetime="2020-09-14T17:43:50&#43;0800" class="post-date">Mon, Sep 14, 2020</time>
  
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://hlcooll.github.io/public/post/first/">First</a>
  </h1>
  <time datetime="2020-09-14T14:31:26&#43;0800" class="post-date">Mon, Sep 14, 2020</time>
  
  
</article>
</div>
    </main>

    
      
    
  </body>
</html>
